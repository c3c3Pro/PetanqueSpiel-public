(()=>{var e=L.map("map").setView([51.1657,10.4515],6);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap contributors"}).addTo(e),e.on("click",(async n=>{const{lat:t,lng:r}=n.latlng,o=await async function(e,n){const t=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${n}`;try{const e=await fetch(t),n=await e.json();return n.address&&"Germany"===n.address.country}catch(e){return console.error("Der Bereich ist ausserhalb von Deutschland: ",e),!1}}(t,r);if(!o)return void alert("Dieser Ort liegt ausserhalb Deutschlands. Bitte waehlen Sie eine deutsche Position aus!");const a=prompt("den Name eintragen: ");if(!a)return;const i=prompt("den Zugang eintragen (oeffentlich oder Privat): ");if(!i)return;const s=prompt("Outdoor oder Indoor?:");if(!s)return;const l=prompt("Die Anzahl der Spielfelder eintragen: ");if(!l||isNaN(l))return void alert("Bitte eine gueltige Nummer eingeben: ");const c=prompt("Notizen(optional): "),p={platzName:a,zugang:i,publicAccess:s,anzahlFelder:parseInt(l,10),coords:[n.latlng.lat,n.latlng.lng],notizen:c||""};L.marker(p.coords).addTo(e).bindPopup(`<b>${p.platzName}</b><br>\n        Zugang: ${p.zugang}"<br>\n        Typ: ${p.publicAccess}\n        Feld: ${p.anzahlFelder}<br>\n        Notizen: ${p.notizen}`).openPopup();try{if(!(await fetch("/api/plaetze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Plaetze konnten nicht gespeichert werden");console.log("platz erfolgreich gespeichert")}catch(e){console.log("Fehler beim Speichern des Platzes")}})),async function(){try{const n=await fetch("/api/plaetze");if(!n.ok)throw new Error("Plaetze konnten nicht gespeichert werden");(await n.json()).forEach((n=>{L.marker([n.coords[0],n.coords[1]]).addTo(e).bindPopup(`\n                <b>${n.platzName}</b><br>\n                Zugang: ${n.zugang}<br>\n                Typ: ${n.publicAccess}<br>\n                Spielfelder: ${n.anzahlFelder}<br>\n                Notizen: ${n.notizen||"Keine"}\n            `)}))}catch(e){console.error("Fehler beim Aufruf des Ortes")}}()})();